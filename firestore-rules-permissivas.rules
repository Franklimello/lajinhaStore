rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // ========================================
    // REGRAS PERMISSIVAS PARA DESENVOLVIMENTO
    // ========================================
    
    // Regras para produtos - LEITURA LIVRE
    match /produtos/{produtoId} {
      allow read: if true; // Qualquer um pode ler produtos
      allow write: if request.auth != null; // Apenas usuários logados podem escrever
    }
    
    // Regras para categorias - LEITURA LIVRE
    match /categorias/{categoriaId} {
      allow read: if true; // Qualquer um pode ler categorias
      allow write: if request.auth != null; // Apenas usuários logados podem escrever
    }
    
    // Regras para pedidos - USUÁRIOS AUTENTICADOS
    match /pedidos/{pedidoId} {
      allow create: if request.auth != null && request.resource.data.userId == request.auth.uid;
      allow read: if request.auth != null && (resource.data.userId == request.auth.uid || request.auth.uid == "ZG5D6IrTRTZl5SDoEctLAtr4WkE2");
      allow update: if request.auth != null && (resource.data.userId == request.auth.uid || request.auth.uid == "ZG5D6IrTRTZl5SDoEctLAtr4WkE2");
      allow delete: if request.auth != null && request.auth.uid == "ZG5D6IrTRTZl5SDoEctLAtr4WkE2";
    }
    
    // Regras para usuários - USUÁRIOS AUTENTICADOS
    match /usuarios/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
      allow read: if request.auth != null && request.auth.uid == "ZG5D6IrTRTZl5SDoEctLAtr4WkE2"; // Admin pode ler todos
    }
    
    // Regras para notificações - ADMIN E USUÁRIOS
    match /notificacoes/{notificacaoId} {
      allow read: if request.auth != null && (resource.data.userId == request.auth.uid || request.auth.uid == "ZG5D6IrTRTZl5SDoEctLAtr4WkE2");
      allow create: if request.auth != null;
      allow update: if request.auth != null && (resource.data.userId == request.auth.uid || request.auth.uid == "ZG5D6IrTRTZl5SDoEctLAtr4WkE2");
      allow delete: if request.auth != null && request.auth.uid == "ZG5D6IrTRTZl5SDoEctLAtr4WkE2";
    }
    
    // Regras para configurações - ADMIN APENAS
    match /configuracoes/{configId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null && request.auth.uid == "ZG5D6IrTRTZl5SDoEctLAtr4WkE2";
    }
    
    // Regras para relatórios - ADMIN APENAS
    match /relatorios/{relatorioId} {
      allow read, write: if request.auth != null && request.auth.uid == "ZG5D6IrTRTZl5SDoEctLAtr4WkE2";
    }
    
    // Regras para logs - ADMIN APENAS
    match /logs/{logId} {
      allow read, write: if request.auth != null && request.auth.uid == "ZG5D6IrTRTZl5SDoEctLAtr4WkE2";
    }
    
    // Regra padrão - NEGAR TUDO
    match /{document=**} {
      allow read, write: if false;
    }
  }
}

